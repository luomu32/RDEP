- PageRequest没有无参的构造方法，Dubbo默认采用hessian作为序列化，会出现无法实例化的问题。
解决办法：1.换序列化方式。2.参数不采用PageRequest，采用自定义对象，调用时进行转换。
- [ ] Apache Common Exec，执行命令，如果目录有空格，需要加“/”对空格进行转义，而CommandLine会对“/”进行转换（有些操作系统路径使用“/”有些使用“\”），导致目录不正确，命令执行失败
- [ ] Apache Common Exec，目录有中文，变成“？？”，疑似乱码。
- [x] Spring Cloud Gateway与JWT集成问题。毫无疑问，JWT的Token肯定是需要在Gateway中校验，通过还需要解析，获取信息，加入HttpRequest的Header中传递到下游服务。
Gateway的集群和重启等原因，JWT的Key需要存储在独立服务中，比如磁盘、Redis、数据库等。
- [ ] 上传图片，生成缩略图
- [ ] Spring Data JPA的投影与Specification
- [x] LocalDateTime，序列化/格式化，目前后端不做任何处理，前端展示不友好
- [x] Spring MessageSource问题。注入参数需要使用'{}'。
- [x] Spring MessageSource,basename允许配置多个目录，以逗号分割。由于内部以Set保存，所以不能同名。通过code获取message时，循环遍历多个basename来尝试获取code的message
- [x] server.port设置0，应用启动随机获取端口，配合服务发现，在单机多应用启动很有用。

## 文件上传配置
向容器注册MultipartConfigElement，或使用MultipartProperties
## Spring WebMvc配置
使用`WebMvcConfigurer`，不要使用`@EnableWebMvc`。如果不需要Spring Boot对Web的一些自动配置，那么就使用`@EnableWebMvc`和`WebMvcConfigurationSupport`。

如果需要配置`RequestMappingHandlerMapping`、`RequestMappingHandlerAdapter`、`ExceptionHandlerExceptionResolver`，继承`WebMvcRegistrationsAdapter`
## Jackson HttpMessageConvert的配置问题
需要对Jackson做一些配置，比如自定义格式对LocalDate、LocalDateTime格式化输出给前端。
1. 主要使用@Bean向Spring容器注册，容器内如果已有相同的HttpMessageConvert，则会自动替换，如果没有则加入到Converter集合中。
2. 向容器注册Jackson2ObjectMapperBuilderCustomizer，会被Spring容器获取，对Jackson2ObjectMapperBuilder进行设置。Jackson2ObjectMapperBuilder用于构造MappingJackson2HttpMessageConverter。
3. 除此之外，对一些开关性的配置，还有更简便的方式，直接通过properties/yml配置，https://docs.spring.io/spring-boot/docs/2.1.7.RELEASE/reference/html/howto-spring-mvc.html#howto-customize-the-jackson-objectmapper
## MessageCode处理公共code
一些基本异常来公共包中处理，异常信息需要国际化，国际化资源文件也同样放在公共包中。在其他应用中，需配置basename为多个。

## Swagger
- Swagger UI.是一个界面项目，将json文件以图形化的方式展现出来。json就是接口描述文档。Swagger UI可以以Node方式启动，也可以以Docker方式运行。
- Swagger core.好像只支持JAX-RS。使用swagger-maven-plugin，生成出来的openapi.json是空的。资料也很少，很多使用的是第三方的maven plugin。
- Swagger Inflector.基于OAS定义，对未实现的方法生成MOck Response。
- Swagger Parser。读取OpenAPI定义，转换成Java POJO。
- Swagger JS。浏览器或Node应用连接OAS定义API。读取，解析
- Swagger Node。基于Node的设计驱动服务实现。能够在线编辑、生成API。


### Spring应用集成
与Spring MVC嵌入。这种方式有问题，如果web是个集群，那么每个应用都包含swagger静态资源，都暴露API接口。理想的方式还是swagger-ui独立部署。应用通过maven plugin打包时生成json
```xml
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger2</artifactId>
    <version>2.9.2</version>
</dependency>
<dependency>
    <groupId>io.springfox</groupId>
    <artifactId>springfox-swagger-ui</artifactId>
    <version>2.9.2</version>
</dependency>
```
```java
@Configuration
@EnableSwagger2
public class SwaggerConfig {

    @Bean
    public Docket docket() {
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage("xyz.luomu32.dubbo.demo.web.controller"))
                .paths(PathSelectors.any())
                .build();
    }

    public ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("Dubbo示例程序")
                .description("演示Dubbo、dubbo-srping-boot-starter、超时、集群容错、降级、异步等功能")
                .termsOfServiceUrl("")
                .version("1.0")
                .build();
    }
}
```
除了使用springfox，还可以使用第三方的swagger maven plugin。但是必须使用@RquestMapping，不支持@GetMapping、@DeleteMapping等。否则生成的swagger.json是空的

## 代码质量
### sonar
https://www.sonarqube.org/
代码质量管理。支持多种语言
能与CI/CD集成，如Jenkins、Azure DevOps等。Jenkins，执行流程，先执行单元测试，Sonar静态分析，jacoco分析.exec文件
能与Git Review集成。能分析代码库中的分支，当Pull Request时发出通知。


jacoco，测试覆盖率。根据exec文件，生成报告

## 构建设置
Java 虚拟机 flags设置问题，if-else有问题，select控件开启搜索，取消之后值依然在